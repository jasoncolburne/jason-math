RSpec.describe Jason::Math::Cryptography::KeyAgreement::DiffieHellman do
  let(:dh) { described_class.new(:'8192') }
  let(:my_key) { 925736339926782618658618541620822108536372920098823976925187303070923538048990396709187954183012965260200257056813045323 }
  let(:my_shared_value) { 477960888851499795674754180928261694532306732453287982421246573596209396329396198634873988271896770675870643403879469732819945863633363856656163882230012238699354769394218265916942518604429827415686062846122494867058235719295877850901909562410549170202522077853077289260017964228149216831296884108899174552513577020219907697564969034794378494344511602496905256309268168817791730515977250831142754351556275676463648350869922601818204372339394192916348757460636694381508541383927707153830295182398413949269161906138588904036282317351410204570115973848255953385070413704558668009134233655368953839093429878666725950972411931723569448534281309559050338378468428378597161310315894521205126548543333456721088604195602534356067218771058749495102520127634587706335500635328441681759376826797236870144419800715039797468692014456955463032719243569081582953897581201480294950251973234864132239252011582403768569038538727297767565708816956746194881903891824930423474877976522584958753981070175761429646634353144835880714456837529967491232124673709441623785857324792880851469206611720973840247024963374773429154841646266770125413232547555963241195200453996436800074480565491630871472551234682079567528923911940712736826146882175155682437583384891504432329349963743690290111450452034560292939856954328276011306030902927179720875172146476290104514712977025767331693362287502710465354831503725496094676244630149601453736761863901874278840529734305612657033273946268502588755418336949237385805330221792064540958787683847249527632855295793788138770261965086187485345961148086443095892354733014143447942516060361898688283739481766969161404503950389712336328472369301282337268298979581198051026876010408596729643235242306659683747928141453998443027088904946580781691128207823254979374395075904087740776319529582859465036426476959188153677207670420145830802244586493288694346240114195524268753430452348841495283163985715418888876166678209931957274451173888440859254703070141973212449903304948761464840484843355003022817148396090445452340675411646238236735437291582279655372530336999045709397687162878135035145434894360912582072577322323687052171812487149783280364306796385475205587449559146012833220714172466569749760765929819783786246893599956745976666541880772151314200726765890142879097408543895466604681712829059738611271069493254316490358577048081642908617397471113116260676554698592669689295057123673847708223488525094727586003785276890848727589375464691026999893482791920974989419 }
  let(:partner_key) { 902044574499272289034094506576050627465869725381485040460479449407851188423824093714942412932240870201619871452707638825 }
  let(:partner_shared_value) { 633075755265205875476254965828029561313515628709027875995611323033640105881325234487571089741058858159949300923609366047069137084851014768677728912614558791938729741195478579681850728978160857435461943237564707267791952375961457537189809588242664412384325681124628361075384806995081530885962031030624868683981404855344300306006184596484009848918381859637044033731838093282312415810881487076957673711114841270019792450000518394875164570486584456260252164973156262758354618819980643528036599125478774195857421560445569941312240284155527881720806818433044427721181568434833097363153729909591068509770164732360400435884794202669869295564122671260431019006748968125499210211177327104115225169256952526985691224417748763143887367614377024125273717891935915500492802291212688592095310819026012419542762203694458113204951904815668709407333368523467511427234417672925976949773273493106294763289673269181962580522881643839395909897027734045347478865024495671119789170896920817017349089503482231639537055808811719929559096779600612398741362704931423290129990149673444266626792100083769324515559726428296882944317499195101584524966476497132603043987219225953074479064337094055681018468614085431081190869634347636904751514867427063957519471905737270768471619379475910891341545063699669160356931204994327632754381880629823098012180932627920778477497176014059881439131765742387973947098684425285513593715772432599525931883601797092021842200961009520965854403681357055440737735994422403115616392879520072254351363439127026968833768454261530092745406816545524265684416524531401594469166073329438882093935628600376879807067292157887768430916849788158731449300904884839200404828494624157566634959070909884587084566138777011812167532220246785958848041963611417137806887415913708435878912936982020175452532628454180939606696992966481715927716587874567374652058903550097051288654706440692913395646482009235730907363133427309881069529941068861874638654845762979149163146658746637494693617137565159132509187931106182197526393578640484224177998489733038887504154161101217220882666405137578283367738156040712772776459429774221780883852794799011735264081015848490653560263899888409161631492370228444669871608053447908353820412330975564083895622523426971563540356606130700204106644994204151508336723838532498483118722220766463544183379244358787261650043505042065345979235679091651335718677499226081431176326828155046824653469108155839014916414097707397539790560003081702668436700237981030969335 }
  let(:partner_secret) { dh.compute_secret(partner_key, my_shared_value) }

  context 'computes consistent secrets' do
    subject { dh.compute_secret(my_key, partner_shared_value) }
    it { is_expected.to eq(partner_secret) }
  end
end
