# frozen_string_literal: true

RSpec.describe Jason::Math::Cryptography::ExclusiveOrCipher do
  context '#cipher cryptopals example' do
    subject { cipher.decrypt(plaintext) }

    let(:plaintext) { "Burning 'em, if you ain't quick and nimble" }
    let(:key) { 'ICE' }
    let(:cipher) { described_class.new(:repeated_key, key) }
    it {
      is_expected.to eq('0b3637272a2b2e63622c2e69692a23693a2a3c6324202d623d63343c2a26226324272765272a282b2f20'.hex_to_byte_string)
    }
  end

  context '#break_cipher' do
    subject { described_class.break_cipher(cipher_text, key_length_range) }

    context 'cryptopals example' do
      let(:cipher_text) do
        "\x1DB\x1FM\v\x0F\x02\x1FO\x13N<\x1Aie\x1FI\x1C\x0EN\x13\x01\v\aN\e\x01\x16E6\x00\x1E\x01Id T\x1D\x1DC3SNeR\x06\x00GT\x1C\rEM\a\x04\fS\x12<\f\x1E\bI\x1A\t\x11O\x14L!\x1AG+\x00\x05\x1DGY\x11\x04\t\x00d&\aS\x007\x16\x06\f\x1A\x17A\x1D\x01RT0_\x00 \x13\n" \
          "\x05GO\x12H\bENe>\x16\t8E\x06\x05\b\x1AF\aO\x1FYx~jb6\f\x1D\x0FA\rH\x06U\x1A\e\x00\x1DBt\x04\x1E\x01I\x1A\t\x11\x02Rz\x7FI\x00H:\x00\x1A\x13I\x1AOEH\x0F\x1D\rS\x04:\x01R\x19\x01\vA\x13\x06\x00L1_Sb\x15\x06\a\t\aT\v\x17A\x14\x16Iy35\v\e\x01\x05\x0FF\aO\x1DNxNH'R\x04\a\fEXH\bA\x00O T\bt\v\x1D\x19I\x02\x00\x0E\x16\\\x00R0ie\x1FI\x02\x02T\x00\x01\v\aN\x02\x10S\x01&\x10\x15M\x02\a\x02\x1FO\eNx0i6R\n" \
          "\x01\tT\x06\a\tSN\x02\x10S\b;\x10\x06\x05I\x0F\x0F\x10O;\x00:_G+\x1CId3OT\x02\x10S\x1AO\x05\x16\x11t\f\x06M\x0F\x02\x0E\x03CRL=N\x00/\vI\r\bN\x17\r\x15T\x1DO\x0E\x1CE^(\vM\x19\x01\x12\a\n" \
          "USxNOb\x06\x01\vGS\x1D\f\x00\x00\x17\n" \
          "\x05\x1F\f:B^M.\x01A\"\x0E\x1CI4VAb5\x06OG*~;\bO\x01\e\x01SB7\x04\a\x1E\fN\x15\x1C\x0E\x06\a+\x1AT*\x17I\x19\x06YT!EW\a\x03\x05S\a1Ex,\a\n" \
          "A\x1D\tRY7O\x00&\x1D\aI\x13\x00\x13\x01\x13EN\x0EI\x17\x049\v^M\x1D\x06\x04\x1AOxw0C\x00;\x1D\x1CN\x14T\x15\x1A\fNIO\b\aE9\x00Rg:\x01A\x13\n" \
          "\x06\x007\\FbU\n" \
          "\x0F\x12S\x11H,\x00\r\x00\a\a\x17;\tR\x19\x01\vA\a\e\x13G=\x1A*\x16\x1A\f\x1C\x02\a\aH\vON\v\x00\x00\x16=\vUM\b\x02\r\e\x18\x17Dx0ie\x1FI\a\t\x00\x19\x11EO\x19\x01I\x03\r5\x16\x17Mc:\t\x11O\x15I*VI'\x01I\x1D\x06\x00\rH\x11H\v\x16I\x1F\n" \
          "\"\x00R\x00\fN\x00\x1A\vRT0[Tb\e\x1AN\bKTb$N\n" \
          "O S\x065\vR\t\b\x00\x02\x11O\x10E,NE0R\x1D\x06\x06NT\t\vYN\x04\x00\x17E:BR\x1D\x05\x0F\x18Texs,[G'R[NJ\rT1\x00AN\e\x01\x16E;\v\x17M\x10\x0FFT\x18\x13N6[\x00.\e\x1A\x1A\x02NT\x1C\n" \
          "\x00d&\x1DT\x16t\n" \
          "\x14\vI\x03\x18T\a\x17A<\x1AS-R\x05\v\x13\x00\x00\x00\x00\x00\f\n" \
          "\b\aE$\t\x13\x14I\x1A\t\x06\x00\aG0\x1A*\x11\x1DI'GC\x15\x06EF\e\x01\x02S\f E\a\x1DI\x0F\x0F\x10O\x1FA3_\x00+\x06I\x1D\bU\x1A\fEG\x01\x00\rSoeH@@ZN8\eO_\rxqN-\x11\x02N\bNT\e\n" \
          "M\vO\x1E\x1C\n" \
          "0Ex+\x06\x1CA\x13\x00\x1DDxVU!\x19EN.\x00\x18\x01\x0EEN\x02\x10S\x17<\x1C\x1F\b\x1AN\x00\x00\x1D\x1DC1UU1Rc=\x12P\x11\x1A\x06A\x02\x0E\x0F\x01\x043\f\x1E\x04\x1A\x1A\b\x17\n" \
          "\n" \
          "P1[L+\x16\x06\r\x0EO\x01\eE*'H\x04S\x04:E\x17\v\x0F\v\x02\x00O\x13N<\x1AT*\x13\x1DN\x1EO\x01H\x06A\x00O\v\x16\x11to;M\n" \
          "\x0F\x0FT\e\x13K=\x1AAb\x14\x05\x17GG\x1D\x1A\t\x00\x0F\x01\rS\b5\x0E\x17M\x01\v\x13T\x18\x17Tv\x1A*H;N\x03GL\x1D\x03\x00\x00=\x0E\x04\x00\n" \
          ":E_@I=\x00\x19\x1C\x1DNxNOb6\f\x02\x0EL\x15\x00E*:\a\f\x01\x00s\x16R\x03\x06N\x05\x11\x01\vI6\x1D\fb+\x06\eGC\x15\x06ET\x1C\x16I\a\n" \
          "t\r\x13\x03\x0ENk6\x1A\x06\x00!UUe\x1E\x05N\fE\x11\x18ET\x1C\x16\x00\x1DBt\x11\x1DM\x0E\v\x15T\x02\v\x00+NY.\x17Id(V\x11\x1AEA\x00\vI\x1C\x131\x17^M\x19\x1C\x00\x17\e\eC=\x1AM#\x19\f\x1DGP\x11\x1A\x03E\r\eIy'!\x11R\x03\x06\x1AA\x1D\tRY7O\a0\x17I\x0FGL\e\t\x03E\x1CAIyo\r\n" \
          "\aJ\x05\x02A\x13\n" \
          "\x06\x006UW*\x17\e\vK\x00\x1A\aEP\x02\x0E\n" \
          "\x16It\v\x1DM\x1D\a\f\x11CRN7\x1AG+\x00\x05\x1DG*'\a\n" \
          "NNBDS*<E\x1F\x14I)\x0E\x10CRH7WE \x1D\r\x17K\x00\r\a\x10\x00\x1E\x1D\x06\x11\x046\t\vM\f\x0F\x15Te!P9]H'\x06\x1D\aGW\x1D\x1C\r\x00\x0FO\x1A\x03\n" \
          ";\vSM*\x01\f\x11O\x1DNx[N&R\x1A\x0F\x1E\x00\x1D\x1CD\x00de?:5zE$\f\a\a\r\x18\x0ERi;_\x00;\x17\x19BGY\x11\x18I\x00'H\x04S\x06;\b\e\x03NN\t\x15\x1D\x16\x004SK'R\bN\x15H\x1D\x06\n" \
          "\x00d&\a\a\n" \
          ",\f\x11\f\x1D\a\x0F\x13O\x01OxCO7R\x1A\x1A\x06G\x13\r\x17\x00\x02\x06\x02\x16E5E\x05\x04\a\x01A~<\x1D\x00(ON)\x01I\x1D\x13O\x04H\x11R\x17\x06\a\x14E5\v\x16M\x0E\a\x13\x18O\x01T7J\x00!\x00\x10\a\t\aTb3A\x00\x06\x05\x1F\x04t,\x11\bI\a\x12T\x1C\x17L4SNeR\b\x00\x03\x00\r\a\x10\x00\x1E\n" \
          "\x06\x03\t1E\x13\x1F\fN\x03\x01\x16\eN\x7F\x1A*e1\b\e\x14ET\x1F\rYN\e\x01\x16E2\x17\x17\f\x02\x1DA\x15\x1D\x17\x002UC)\e\aIGL\x1D\x03\x00\x00-\x1D\b\t\x1Ct\"\x1E\x18\fNk9\x00\x04I6\x1D\x00#\x1C\rN\x00R\e\a\x13I\x00HI\a\x17-\f\x1C\n" \
          "I\x1A\x0ET\x1C\eN?\x1AA.\x1D\a\tG*5\x04\t\x00\x1A\a\e\x1C\x103\rR\x19\x01\vA\x13\a\x17T,U\x00%\x00\x06\x01\x11I\x1AOET\x06\x06\x1AS\r1\x17\x17M\x1A\x01\x0F\x13Oxn7M\x00;\x1D\x1CI\x15ET\t\bA\x14\n" \
          "\rS\a-E\x06\x05\fN7=?RP7IS'\\Idms\x00\r\x15P\a\x01NS\x16;E\x1A\f\e\n" \
          "A\x18\x06\x19Ex[\x00\x05\x17\e\x03\x06NT&\x04Z\aOc \x115\x17\x06\x01\f\n" \
          "A\x16\x16RT0_\x00 \x13\x1A\v\x14\x00\x1C\x01\x11T\a\x01NS\x02&\n" \
          "\a\x03\rNk \a\x17R=\x1DSb\x1C\x06N\x13R\x1D\x18\x15I\x00HI\x1C\vt\b\e\x03\fBA=H\x1F\x002OS6R\x0E\v\x13T\x1D\x06B\x00\n" \
          "\x00\x1E\x1DE^6\x02\f\e\x05\x00\x19\x0E\x06I;\x16\x00\vU\x04N\x0FA\x1A\x0F\fNIO\x1D\x1A\x02<\x11R\x01\x00\x05\x04T\x0ERF9TA6\e\n" \
          "Nmy\e\x1DET\x1C\x0E\x19\x03\x000E\x1F\bI\x01\x0F\x17\n" \
          "RA6^\x00\vR\x1D\x06\bU\x13\x00\x11\x00\x1A\a\b\aE^<\x1D\x18I\x03\b\x13\a\x06\x000[V'R\x00\x1AG*'\aES\x1A\n" \
          "\x19S\x01;\x12\x1CM\b\x00\x05T\x03\x17N<\x1AM'R\x10\x01\x12RT\r\x04RNeNK\\t\f\x1CM\x04\x17A\x00\x06\x1FEy\x1Ay-\aEN@\x19DH\fSN\x02\x10S\x1C1\x04\x00CIdk-\x00\a\a*_\x005\x17\b\x05\x02N\x1D\x06B\x00\b\x0E\x1A\aIt<=LI\x0F\x0F\x10O;\x00;[Nb\x06\f\x02\v\x00\x1D\x1CE*7\x00\x1C\x01E6\n" \
          "\x16\x14N\x1DA\x13\n" \
          "\x06T1T\ab\x1A\x06\x1AK\x00\a\aI\x00\x1D\x00I:E7\x04\x1CM\x1A\x03\x04\x18\x03RI,\x1A*\x11\x1DI\n" \
          "\bNS\x1CEB\vO\x04\x12\x01t\x04\x1C\tI\n" \
          "\x0E\x1AH\x06\x00:_\x001\x13\rNm\a7\t\x10S\vO\x1D\e\x00t\t\v\x1F\x00\r\x12T\r\x17L7TGb\x06\x06N.c1DEy\x01\x1AI\x10\x04:E\x11\f\x05\x02A\x19\n" \
          "Rd9^\x00H+\x06\e@R\x11H\x15I\x1A\f\x01\x1A\vsE\x13M\x0F\a\x15XO\x01OxIT'\x02I\f\x06C\x1FH\x04N\n" \
          "O\f\x1D\x01!\x17\x17Mc\"\x04\x00O\x06H=\x1AW+\x06\n" \
          "\x06GD\e\v\x11O\x1CCI:\x061IR\t\x06N\x15\x1C\n" \
          "RD9TC'R\x1D\x01GC\x01\x1A\x00\x00d<\x06S\x06;\b\x17M\x1C\x1EA\x17\x03\x1DS=\x1AA,\x16I\n" \
          "\bNS\x1CEB\vO\x1A\x02\x105\x17\x17Mc7\x0E\x01O\x05A6TAb\x10\b\x1A\x13L\x11H\bENBDS$:\x1C\x06\x04\x04\vMT\x0E\x1CY/RE0\x17Idmy\e\x1DET\x06\x00\x1C\x14\r E\x06\x05\b\x1AA=O\x05A+\x1AW'\x13\x02BGb\e\x11I\x00\x17\x00\x1CT\x171E\x16\b\b\n" \
          "A\x03\x1D\x1DN?\x1A*\x11\x1DI\r\bM\x11H\n" \
          "NBO\f\x05\x00&\x1C\x10\x02\r\x17A\x15\x01\x16\x00+SN%R\x1D\x06\x0EST\e\n" \
          "N\tOcy65\x1CR@DN1\x18\x0E\v\x00,RA6R\x0F\e\tK\rH\bU\x1D\x06\n" \
          "S65\x1C^M\x0E\x01A\x03\a\eT=\x1AB-\vEN\x00OT\x1F\rI\x1A\n" \
          "I\x11\n" \
          "-E\x15\x02Id\x11\x18\x0E\v\x00,RA6R\x0F\e\tK\rH\bU\x1D\x06\n" \
          "S\";E\x05\x05\x00\x1A\x04T\r\x1DYt\x1AG-R\x1E\x06\x0ET\x11H\aO\x17CI\x14\n" \
          "to>\f\x10N\x05\e\x18\x1C\x009TDb\x10\x06\x01\x00I\x11H\x04N\n" \
          "O\x19\x1F\x04-E\x06\x05\b\x1AA\x12\x1A\x1CK!\x1AM7\x01\x00\rGT\x1D\x04\t\x00\x17\x00\x1CS\x01=\x00\\Mcd1\x18\x0E\v\x00,RA6R\x0F\e\tK\rH\bU\x1D\x06\n" \
          "S&;\b\x17M\x06\x00MT,\x1DM=\x1AO,^I\x02\x02TT\x05\x00\x00\x06\n" \
          "\b\x01E^5\x1E\f\x10N\x15\x1C\x0E\x06\x00>ON)\vI\x03\x12S\x1D\vEW\x06\x06\x1D\x16E6\n" \
          "\vM\x10\x01\x14T\x1C\x13YxSTnR\x1A\x0F\x1E\x00\x1D\x1CE*>\x03\b\n" \
          "E \r\x13\x19I\b\x14\x1A\x04\v\x005OS+\x11I/GL\x1D\x1C\x11L\vO\x05\x1C\x100\x00\x00M\a\x01\x16Te\"L9C\x006\x1A\b\x1AGF\x01\x06\x0EYN\x02\x1C\x00\f7IR\x1A\x01\a\x15\x11O\x10O!\x1Ac-\x1F\fN\bNXH&O\x03\n" \
          "I\x1C\vxE1\x02\x04\vA\e\x01R*\bVA;R\x1D\x06\x06TT\x0E\x10N\x05\x16I\x1E\x10'\f\x11Mc"
      end
      let(:key_length_range) { 2..40 }

      it { is_expected.to eq('Terminator X: Bring the noise') }
    end
  end
end
